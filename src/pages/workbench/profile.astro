---
import WorkbenchLayout from '../../components/layouts/WorkbenchLayout.astro';
import { createSupabaseServer } from '../../lib/supabaseServer';

// Get user
const supabase = createSupabaseServer(Astro.cookies);
const { data: { user } } = await supabase.auth.getUser();

if (!user) {
  return Astro.redirect('/login');
}

const userEmail = user.email || '';
const userName = user.user_metadata?.name || userEmail.split('@')[0];
---

<WorkbenchLayout title="Profile - Workspace">
  <!-- Profile Header -->
  <div class="content-section mb-6">
    <div class="flex items-start gap-6">
      <!-- Avatar -->
      <div class="flex items-center justify-center w-24 h-24 rounded-full bg-primary text-white text-3xl font-bold">
        {userName[0].toUpperCase()}
      </div>

      <!-- User Info -->
      <div class="flex-1">
        <h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2">{userName}</h1>
        <p class="text-gray-600 dark:text-gray-400 mb-4">{userEmail}</p>

        <div class="flex gap-2">
          <a href="/settings" class="btn-primary btn-sm">
            Edit Profile
          </a>
          <button class="btn-ghost btn-sm">
            Share Profile
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Stats -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-5 mb-6">
    <div class="stat-card">
      <div class="stat-label">Projects</div>
      <div class="stat-value">0</div>
      <div class="stat-description">Public projects</div>
    </div>

    <div class="stat-card">
      <div class="stat-label">Updates</div>
      <div class="stat-value">0</div>
      <div class="stat-description">Published</div>
    </div>

    <div class="stat-card">
      <div class="stat-label">Contributions</div>
      <div class="stat-value">0</div>
      <div class="stat-description">To Commons</div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="content-section">
    <div class="border-b border-gray-200 dark:border-gray-700 mb-6">
      <nav class="flex gap-6">
        <button class="px-1 pb-3 text-sm font-medium border-b-2 border-primary text-primary">
          Projects
        </button>
        <button class="px-1 pb-3 text-sm font-medium border-b-2 border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:border-gray-300 dark:hover:border-gray-600">
          Updates
        </button>
        <button class="px-1 pb-3 text-sm font-medium border-b-2 border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:border-gray-300 dark:hover:border-gray-600">
          Activity
        </button>
      </nav>
    </div>

    <!-- Tab Content -->
    <div class="py-12">
      <div class="text-center">
        <div class="mx-auto w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-gray-400">
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z" />
          </svg>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2">No public projects yet</h3>
        <p class="text-sm text-gray-600 dark:text-gray-400">Projects you make public will appear here</p>
      </div>
    </div>
  </div>
</WorkbenchLayout>
