# =============================================================================
# Workspace by Ali - Environment Variables Template
# =============================================================================
#
# This is a template for setting up your self-hosted workspace.
# Copy this file to `.env` and fill in your own values.
#
# IMPORTANT: Never commit `.env` to version control!
#
# =============================================================================

# =============================================================================
# DEPLOYMENT MODE
# =============================================================================
# Set to 'production' when deploying to Vercel
NODE_ENV=development

# =============================================================================
# SITE CONFIGURATION
# =============================================================================
# Your workspace's public URL
# Development: http://localhost:4321
# Production: https://your-workspace.vercel.app
PUBLIC_SITE_URL=http://localhost:4321

# Your workspace name (shown in UI)
WORKSPACE_NAME=My Research Workspace

# Your workspace description
WORKSPACE_DESCRIPTION=A self-hosted workspace for open research

# =============================================================================
# SUPABASE CONFIGURATION
# =============================================================================
# Create a Supabase project: https://supabase.com/dashboard
# Get these from: Project Settings → API
#
# IMPORTANT: Create your own Supabase project for your workspace!

# Public Supabase URL (safe to expose to client)
PUBLIC_SUPABASE_URL=https://YOUR_PROJECT_ID.supabase.co

# Public Supabase Anonymous Key (safe to expose to client)
PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key_here

# Service Role Key (server-side only - NEVER expose to client!)
# This key has full database access - keep it secret!
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here

# =============================================================================
# GITHUB OAUTH CONFIGURATION
# =============================================================================
# Create a GitHub OAuth App: https://github.com/settings/developers
#
# OAuth App Settings:
# - Application name: [Your Workspace Name]
# - Homepage URL: http://localhost:4321 (dev) or https://your-workspace.vercel.app (prod)
# - Authorization callback URL: [Homepage URL]/api/auth/github-callback
#
# IMPORTANT: Create your own OAuth app for your workspace!

# GitHub OAuth Client ID (public - safe to expose)
PUBLIC_GITHUB_CLIENT_ID=your_github_client_id_here

# GitHub OAuth Client Secret (server-side only - keep secret!)
GITHUB_CLIENT_SECRET=your_github_client_secret_here

# =============================================================================
# KEYSTATIC CMS CONFIGURATION
# =============================================================================
# Your GitHub repository that stores workspace content (created during setup)
# This is YOUR forked workspace repo, NOT the template repo!
#
# How to find these values:
# 1. Complete the setup wizard at /setup
# 2. Look at your GitHub repos - you'll have a new repo like "workspace-alice"
# 3. Your repo URL will be: https://github.com/[OWNER]/[NAME]
#
# Example:
# - GitHub username: alice
# - Forked repo name: workspace-alice
# - Set: PUBLIC_KEYSTATIC_GITHUB_REPO_OWNER=alice
# - Set: PUBLIC_KEYSTATIC_GITHUB_REPO_NAME=workspace-alice

PUBLIC_KEYSTATIC_GITHUB_REPO_OWNER=writingsbyali-hub
PUBLIC_KEYSTATIC_GITHUB_REPO_NAME=yworkspace-by-ali


# =============================================================================
# GITHUB WEBHOOK CONFIGURATION
# =============================================================================
# Secret for verifying GitHub webhook signatures
# Used to automatically update cache when you push to your workspace repo
#
# Generate a random secret:
# node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# IMPORTANT: Add this same secret when registering webhooks in GitHub!

GITHUB_WEBHOOK_SECRET=GENERATE_YOUR_OWN_WEBHOOK_SECRET_HERE

# =============================================================================
# GITHUB TOKEN ENCRYPTION
# =============================================================================
# Encryption key for storing GitHub tokens securely in database
#
# CRITICAL: Generate a random 32-byte key and NEVER CHANGE IT!
# If you change this key, all stored tokens will be unrecoverable!
#
# Generate a key (Node.js):
# node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
#
# Or generate online: https://generate-random.org/base64-string-generator

GITHUB_TOKEN_ENCRYPTION_KEY=GENERATE_YOUR_OWN_32_BYTE_BASE64_KEY_HERE

# =============================================================================
# GITHUB TEMPLATE REPOSITORY
# =============================================================================
# The template repository that users fork to create their workspace content repo
# Default: workspace-by-ali/workspace-template (official template)
#
# You can create your own template repo with custom structure/examples

TEMPLATE_REPO_OWNER=workspace-by-ali
TEMPLATE_REPO_NAME=workspace-template

# =============================================================================
# READER ACCOUNTS CONFIGURATION
# =============================================================================
# Enable/disable reader (guest) accounts on your workspace
# Readers can sign up to view gated content without deploying their own workspace
# Set to 'true' or 'false'

ALLOW_READERS=true

# Enable/disable reader suggestions (comments on your content)
ALLOW_SUGGESTIONS=true

# Auto-approve suggestions from expert readers
# If false, all suggestions require manual approval
AUTO_APPROVE_EXPERTS=false

# =============================================================================
# DEFAULT LICENSE
# =============================================================================
# Default Creative Commons license for your projects
# Options:
# - CC-BY-4.0 (Attribution)
# - CC-BY-SA-4.0 (Attribution-ShareAlike)
# - CC-BY-NC-4.0 (Attribution-NonCommercial)
# - CC-BY-NC-SA-4.0 (Attribution-NonCommercial-ShareAlike)
# - CC-BY-ND-4.0 (Attribution-NoDerivatives)
# - CC0-1.0 (Public Domain Dedication)

DEFAULT_LICENSE=CC-BY-NC-SA-4.0

# =============================================================================
# SAFETY PROTOCOLS
# =============================================================================
# Safety protocol version for dangerous/sensitive content
# Update this when you change your safety documentation
# Readers must re-acknowledge when version changes

SAFETY_PROTOCOL_VERSION=v1.0

# =============================================================================
# COMMONS SAFETY REGISTRY (Optional - For Arc^ or other Commons)
# =============================================================================
# If you're contributing to a Commons (like Arc^), add the registry URL
# This prevents duplicate safety acknowledgments across workspaces
# Leave empty if not using Commons

COMMONS_SAFETY_REGISTRY_URL=
COMMONS_SAFETY_REGISTRY_KEY=

# =============================================================================
# JWT SECRET (Future Use)
# =============================================================================
# Secret for signing JWT tokens (for future API access keys feature)
# Generate: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"

JWT_SECRET=GENERATE_YOUR_OWN_JWT_SECRET_HERE

# =============================================================================
# OPTIONAL: EMAIL CONFIGURATION (Future)
# =============================================================================
# For sending magic links, notifications, etc.
# Currently handled by Supabase Auth

# SMTP_HOST=
# SMTP_PORT=
# SMTP_USER=
# SMTP_PASS=
# SMTP_FROM=

# =============================================================================
# OPTIONAL: ANALYTICS (Future)
# =============================================================================
# If you want to track usage (privacy-respecting analytics only!)

# PLAUSIBLE_DOMAIN=
# UMAMI_WEBSITE_ID=

# =============================================================================
# SENTRY ERROR TRACKING (Recommended for Production)
# =============================================================================
# Error tracking and performance monitoring
# Docs: docs/setup/SENTRY_SETUP.md
#
# Setup:
# 1. Sign up at https://sentry.io (free tier: 50k errors/month)
# 2. Create an Astro project
# 3. Copy your DSN below
# 4. Install: npm install @sentry/astro
# 5. Deploy and watch errors appear in Sentry dashboard
#
# Benefits:
# - Instant alerts when errors occur in production
# - Detailed stack traces with user context
# - Performance monitoring (slow API calls, database queries)
# - Session replay to see what users experienced
#
# Cost: Free for small projects, $26/month for Team plan

# Sentry Data Source Name (get from sentry.io project settings)
# This is SAFE to expose publicly (it's a public identifier)
# Format: https://abc123@o123456.ingest.sentry.io/7890123
PUBLIC_SENTRY_DSN=

# Optional: For uploading source maps in CI/CD (readable stack traces)
# Get token from: https://sentry.io/settings/account/api/auth-tokens/
# Scopes needed: project:releases, project:write
# SENTRY_AUTH_TOKEN=
# SENTRY_ORG=your-org-slug
# SENTRY_PROJECT=workspace-by-ali

# =============================================================================
# SETUP CHECKLIST
# =============================================================================
#
# Before deploying your workspace, complete these steps:
#
# [ ] 1. Create a Supabase project and add URL + keys above
# [ ] 2. Run the migration SQL files in Supabase SQL Editor:
#        - supabase-migration-git-first.sql
#        - supabase/migrations/20241106000000_self_hosted_owner_reader.sql
# [ ] 3. Create a GitHub OAuth App and add Client ID + Secret above
# [ ] 4. Generate and add GITHUB_TOKEN_ENCRYPTION_KEY (never change after!)
# [ ] 5. Generate and add JWT_SECRET
# [ ] 6. Update PUBLIC_SITE_URL to your deployment URL (Vercel)
# [ ] 7. Update GitHub OAuth callback URL to match your deployment
# [ ] 8. Set WORKSPACE_NAME and WORKSPACE_DESCRIPTION
# [ ] 9. Configure ALLOW_READERS, DEFAULT_LICENSE as desired
# [ ] 10. Test locally with `npm run dev`
# [ ] 11. Deploy to Vercel and add environment variables there
#
# =============================================================================
# DEPLOYMENT TO VERCEL
# =============================================================================
#
# When deploying to Vercel:
#
# 1. Add ALL these environment variables in Vercel dashboard:
#    Project Settings → Environment Variables
#
# 2. Make sure to set NODE_ENV=production for production deployment
#
# 3. Update your GitHub OAuth app callback URL to:
#    https://your-workspace.vercel.app/api/auth/github-callback
#
# 4. Update PUBLIC_SITE_URL to:
#    https://your-workspace.vercel.app
#
# =============================================================================
